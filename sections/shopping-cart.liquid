<section
  class="w-screen h-full bg-[#F5F5F5] flex md:pt-30 pt-20 py-20"
  style="margin-left: calc(50% - 50vw); margin-right: calc(50% - 50vw);"
>
  <div class="w-full px-6 md:px-30 font-bricolage flex flex-col flex-1 ">

    <!-- TITLE -->
    <h1 class="text-3xl md:text-4xl font-semibold text-black mb-12 py-10">
      Shopping Cart
    </h1>

    {% if cart.item_count > 0 %}

    <form action="{{ routes.cart_url }}" method="post" class="flex-1 flex flex-col">

      <div class="grid grid-cols-1 gap-10 flex-1 w-full">

        <div class="md:col-span-2 md:space-y-6 bg-white rounded-xl md:px-10 px-4">

          <div class="grid md:grid-cols-[2fr_1fr_1fr_1fr] grid-cols-[1fr_1fr_1fr] md:py-10 pt-5 pb-10"> 
            <h3 class="md:text-2xl text-md font-bold text=left md:pl-10 ">Product</h3>
            <h3 class="md:text-2xl font-bold text-center">Quantity</h3>
            <h3 class="md:text-2xl font-bold text-center">Total</h3>
            <h3 class="md:text-2xl font-bold text-center"></h3>
          </div>
          {% for item in cart.items %}
          <div class="grid md:grid-cols-[2fr_1fr_1fr_1fr] grid-cols-[1fr_1fr_1fr]
             md:py-10 py-3 md:px-5 items-center ">

            
            <div class="flex md:flex-row flex-col md:items-center ">
                <div class="md:w-44 md:h-44 w-24 h-24 overflow-hidden shrink-0 rounded-lg">
                  <img
                    src="{{ item.image | image_url: width: 300 }}"
                    alt=""
                    class="w-full h-full object-cover"
                    loading="lazy"
                    width="{{ item.image.featured_media.width }}"
                    height="{{ item.image.featured_media.height }}"
                  >
                </div>
                

                <div class="flex-1 md:px-10">
                  <h3 class="md:text-xl text-sm font-medium">
                    {{ item.product.title }}
                  </h3>

                  {% if item.variant.title != 'Default Title' %}

                      {% assign parts = item.variant.title | split: '/' %}
                      {% assign servings = parts[0] | strip %}
                      {% assign grams = parts[1] | strip | remove: 'gr' | strip %}
                    
                    <p class="text-sm text-gray-500 mt-1">
                       {{ servings }} servings, {{ grams }} grams
                    </p>
                  {% endif %}

                  
                </div>


            </div>
            
            {% comment %} cantidad  {% endcomment %}
            <div class="justify-self-center self-center">
              <div class="flex items-center justify-between md:w-28 md:h-10 w-20 h-10 border border-black rounded-full px-2">
                
                <button
                  type="button"
                  onclick="
                    this.nextElementSibling.stepDown();
                    submitCartForm(this);
                  "
                  class="w-6 h-6 flex items-center justify-center rounded-full border border-black text-sm hover:bg-black hover:text-white transition"
                >
                  −
                </button>

                <input
                  type="number"
                  name="updates[{{ item.key }}]"
                  value="{{ item.quantity }}"
                  min="0"
                  class="w-8 h-full text-center outline-none border-0 bg-transparent 
                        font-medium leading-none appearance-none
                        [&::-webkit-inner-spin-button]:appearance-none
                        [&::-webkit-outer-spin-button]:appearance-none"
                />



                <button
                  type="button"
                  onclick="
                    this.previousElementSibling.stepUp();
                    submitCartForm(this);
                  "
                  class="w-6 h-6 flex items-center justify-center rounded-full border border-black text-sm hover:bg-black hover:text-white transition"
                >
                  +
                </button>



              </div>
            </div>


            <div class="justify-self-center self-center">
              <p class="text-2xl font-semibold">
                {{ item.final_line_price | money }}
              </p>
            </div>
            
            {% comment %} remove {% endcomment %}
            <div class="hidden md:block justify-self-center self-center">
              <button
                type="submit"
                name="updates[{{ item.key }}]"
                value="0"
                class="cursor-pointer"
              >
                {% render 'trash' %}
              </button>

            </div>
            

          </div>
          {% endfor %}

        </div>
        <button type="submit" class="hidden" name="update">
          Update cart
        </button>


        {% comment %} total del carrito y checkout {% endcomment %}
        <div class="md:col-span-2 space-y-6 bg-white rounded-xl md:px-20 px-5 py-10 min-h-50">

          <div class="grid grid-cols-1 md:grid-cols-2 gap-40">

            <!-- izq -->
            <div>

              <h2 class="text-3xl md:text-2xl font-semibold text-black pb-5">
                Order Summary
              </h2>

              {% comment %} Código de descuento {% endcomment %}
              {% comment %} <div class="mb-6 roundedfull py-3">
                <label class="block text-sm mb-2"></label>
                <input
                  type="text"
                  placeholder="Discount code"
                  
                  class="w-full rounded-2xl px-4 py-3 bg-gray-100 text-gray-500 "
                >
              </div> {% endcomment %}

              {% comment %} Subtotal {% endcomment %}
              <div class="flex justify-between mb-4">
                <span class="text-lg text-gray-600">Subtotal</span>
                <span class="text-lg font-medium">
                  {{ cart.items_subtotal_price | money }}
                </span>
              </div>

              {% comment %} Descuentos {% endcomment %}
              {% if cart.total_discount > 0 %}
              <div class="flex justify-between mb-4 text-green-600">
                <span class="text-lg">Discount</span>
                <span class="text-lg font-medium">
                  -{{ cart.total_discount | money }}
                </span>
              </div>
              {% endif %}

              {% comment %} Envío {% endcomment %}
              <div class="flex justify-between mb-4">
                <span class="text-lg text-gray-600">Shipping</span>
                <span class="md:text-lg text-xs items-center">Calculated at checkout</span>
              </div>

            </div>

            <!-- derecha -->
            <div class="flex flex-col justify-between">

              {% comment %} Total {% endcomment %}
              <div class="flex justify-between items-center mb-8">
                <h2 class="text-3xl md:text-2xl font-semibold py-2">
                  Total
                </h2>
                <span class="text-3xl md:text-2xl font-bold">
                  {{ cart.total_price | money }}
                </span>
              </div>

              {% comment %} Checkout {% endcomment %}
              <button
                type="submit"
                name="checkout"
                class="w-full bg-black text-white md:py-4 py-2 rounded-full text-lg font-medium
                      hover:bg-gray-800 transition cursor-pointer"
              >
                Checkout
              </button>



             

            </div>

          </div>

        </div>

        

      </div>

    </form>

    {% else %}

    <!-- EMPTY CART -->
    <div class="flex-1 flex flex-col items-center justify-center text-center w-full min-h-100">
      <p class="text-xl mb-6">Your cart is empty</p>
      <a
        href="{{ routes.all_products_collection_url }}"
        class="bg-black text-white px-8 py-3 rounded-lg"
      >
        Continue Shopping
      </a>
    </div>

    {% endif %}

  </div>
</section>

<script>
  function submitCartForm(el) {
    const form = el.closest('form');
    if (form) {
      form.submit();
    }
  }
</script>

{% schema %}
{
  "name": "Shopping cart",
  "settings": [],
  
  "presets": [{ "name": "Shopping cart" }]
}
{%  endschema %}