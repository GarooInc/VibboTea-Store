<div class="grid grid-cols-1 xl:grid-cols-2 gap-8 items-center md:px-5 md:py-10 md:pt-40 pt-25">

  {% if product %}
    {% if product.media.size > 1 %}

    <!-- SLIDER -->
    <div class="relative w-full overflow-hidden rounded-xl" id="productSlider">
      
      <div class="flex transition-transform duration-500" id="sliderTrack">
        {% for media in product.media %}
          {% if media.media_type == "image" %}
            
            <div class="w-full shrink-0 aspect-square overflow-hidden rounded-xl">
              <img
                src="{{ media | image_url: width: 1200 }}"
                alt="{{ media.alt | escape }}"
                class="w-full h-full object-cover object-[center_55%]"
                width="{{ media.width }}"
                  height="{{ media.height }}"
              />
            </div>


          {% endif %}
        {% endfor %}
      </div>


      <!-- BOTONES -->
      <button 
        class="absolute left-0 top-1/2 -translate-y-1/2   
        text-black px-3 py-2  "
        onclick="slidePrev()">
        {% render 'arrow-slidder2' %}
      </button>

      <button 
        class="absolute right-0 top-1/2 -translate-y-1/2  
        text-black px-3 py-2 "
        onclick="slideNext()">
        {% render 'arrow-slidder' %}
      </button>

    </div>

        
    {% else %}
        <div class="product-media w-full justify-center ">
        {% if product.featured_media %}
            <img 
            src="{{ product.featured_media | image_url: width: 1200 }}"
            alt="{{ product.featured_media.alt | escape }}"
            class="w-full h-auto object-cover rounded-xl"
            width="{{ product.featured_media.width }}"
            height="{{ product.featured_media.height }}"
            />
        {% endif %}
        </div>

       
    {% endif %}
     <div class="product-info w-full  px-4">
        <h1 class="text-3xl md:text-4xl font-bricolage font-medium text-black mb-4">
          {{ product.title }}</h1>
        <p class="prose text-xs text-black font-bricolage pt-4">
            {{ product.description }}
        </p>
        {% comment %} variantes {% endcomment %}
        {% if product.variants.size > 1 %}
          {{ product.variants.size }}
          {% assign first_variant = product.selected_or_first_available_variant %}

          <div class="w-full grid grid-cols-3 md:gap-8 gap-4 pt-5 h-full">
            {% for variant in product.variants %}
              {% assign parts = variant.title | split: '/' %}
              {% assign servings = parts[0] | strip %}
              {% assign grams = parts[1] | strip | remove: 'gr' | strip %}

              <div
                class="variant-option rounded-xl min-h-[6vw] w-full flex flex-col 
                      items-center justify-center cursor-pointer border border-gray-400
                      transition-all duration-300
                      {% if variant.id == first_variant.id %}ring-2 ring-black scale-105{% endif %}"
                data-variant-id="{{ variant.id }}"
                data-price="{{ variant.price | money }}"
                data-price-raw="{{ variant.price }}"
                data-compare="{{ variant.compare_at_price | money }}"
                data-compare-raw="{{ variant.compare_at_price }}"
              >
                <p class="font-bricolage md:text-2xl text-md pt-3">
                  {{ servings }} servings
                </p>

                <p class="font-bricolage md:text-xl text-sm py-2">
                  {{ grams }} grams
                </p>
              </div>
            {% endfor %}
          </div>

        {% endif %} 

      

      {% comment %} precio {% endcomment %}
      <div id="priceWrapper" class="py-10 flex items-center gap-4 transition-all duration-300 md:min-h-[10vw] ">
        {% if first_variant.compare_at_price > first_variant.price %}
          <span id="comparePrice" class="text-3xl md:text-4xl text-gray-400 line-through">
            {{ first_variant.compare_at_price | money }}
          </span>

          <span id="mainPrice" class="text-4xl md:text-5xl text-red-700 font-light">
            {{ first_variant.price | money }}
          </span>
        {% else %}
          <span id="mainPrice" class="text-4xl md:text-5xl text-gray-700">
            {{ first_variant.price | money }}
          </span>
        {% endif %}
      </div>


      <form method="post" action="/cart/add" class="w-full md:py-10 items-end text-center mx-auto">
        <input type="hidden" name="id" id="variantInput"
              value="{{ first_variant.id }}">

        <button type="submit"
          class="bg-black flex items-center justify-center w-full rounded-3xl py-3 
                hover:opacity-70 transition-opacity">
          <span class="font-bricolage text-white xl:text-sm text-md uppercase font-light">
            Add to cart
          </span>
        </button>
      </form>

        

    </div>
        

  {% else %}
    <div class="col-span-2 text-center text-sm text-gray-500">No product selected in section settings.</div>
  {% endif %}

</div>

<script>
  const variants = document.querySelectorAll('.variant-option');
  const variantInput = document.getElementById('variantInput');
  const priceWrapper = document.getElementById('priceWrapper');
  const mainPrice = document.getElementById('mainPrice');

  variants.forEach(option => {
    option.addEventListener('click', () => {
      variants.forEach(v => {
        v.classList.remove('ring-2', 'ring-black', 'scale-105');
      });

      option.classList.add('ring-2', 'ring-black', 'scale-105');

      variantInput.value = option.dataset.variantId;

      priceWrapper.classList.add('opacity-0', 'translate-y-2');

      setTimeout(() => {
        const price = option.dataset.price;
        const compare = option.dataset.compare;

        if (compare && compare !== '') {
          priceWrapper.innerHTML = `
            <span class="text-3xl md:text-4xl text-gray-400 line-through">
              ${compare}
            </span>
            <span class="text-4xl md:text-5xl text-red-700 font-light">
              ${price}
            </span>
          `;
        } else {
          priceWrapper.innerHTML = `
            <span class="text-5xl md:text-6xl text-gray-700">
              ${price}
            </span>
          `;
        }

        priceWrapper.classList.remove('opacity-0', 'translate-y-2');
      }, 200);
    });
  });
</script>


<script>
    let currentSlide = 0;

    function slideNext() {
    const track = document.getElementById("sliderTrack");
    const slides = track.children.length;

    currentSlide = (currentSlide + 1) % slides;
    track.style.transform = `translateX(-${currentSlide * 100}%)`;
    }

    function slidePrev() {
    const track = document.getElementById("sliderTrack");
    const slides = track.children.length;

    currentSlide = (currentSlide - 1 + slides) % slides;
    track.style.transform = `translateX(-${currentSlide * 100}%)`;
    }
</script>


{% schema %}
{
  "name": "Description product",
  "settings": [],
  
  "presets": [{ "name": "Description product" }]
}
{% endschema %}