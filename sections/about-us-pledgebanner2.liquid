<section class="full-width flex flex-col font-bricolage min-h-screen relative">
  <div
  class="w-full px-6 lg:px-28 md:py-20 py-10
         bg-[#FFF4DA] bg-cover bg-center bg-no-repeat h-1/2 sm:h-2/3 relative"
  style="
    {% if section.settings.bg_image %}
      background-image: url('{{ section.settings.bg_image | image_url: width: 2000 }}');
    {% endif %}">
    <div class="absolute inset-0 bg-black opacity-30">

    </div>

      {% if section.settings.eyebrow != blank %}
        <p class="text-2xl md:text-7xl sm:text-5xl mx-auto font-bold text-white z-10 relative">
          {{ section.settings.eyebrow }}</p>
      {% endif %}

      <div class="w-full flex justify-end">
        {% if section.settings.title != blank %}
          <h2 class="text-4xl md:text-3xl sm:text-3xl font-bold w-full 
            text-right tracking-tight text-white max-w-2xl sm:max-w-md md:max-w-2xl pt-2 relative z-10">
            {{ section.settings.title }}</h2>
        {% endif %}
      </div>
    </div>


      <div class="w-full absolute justify-center items-center pt-50">
        <div class="hidden sm:grid sm:grid-cols-3 w-full gap-6 sm:gap-5 p-10 sm:pt-10 lg:pt-20 sm:px-5 lg:px-20 pt-42">
            <div class="relative w-full md:h-[420px] overflow-hidden rounded-xl">
              <img 
                src="{{ section.settings.image | img_url: '2000x2000' }}" 
                alt="Imagen 1"
                class="w-full h-full object-cover object-center"
                width="{{ section.settings.image.width }}"
                height="{{ section.settings.image.height }}"
              >
            </div>

            <div class="relative w-full md:h-[420px] overflow-hidden rounded-xl">
              <img 
                src="{{ section.settings.image2 | img_url: '2000x2000' }}" 
                alt="Imagen 2"
                class="w-full h-full object-cover object-center"
                width="{{ section.settings.image2.width }}"
                height="{{ section.settings.image2.height }}"
              >
            </div>

            <div class="relative w-full md:h-[420px] overflow-hidden rounded-xl">
              <img 
                src="{{ section.settings.image3 | img_url: '2000x2000' }}" 
                alt="Imagen 3"
                class="w-full h-full object-cover object-center"
                width="{{ section.settings.image3.width }}"
                height="{{ section.settings.image3.height }}"
              >
            </div>
        </div>

        <div class="sm:hidden relative w-full px-4 pt-20">
          <div class="carousel-wrapper-{{ section.id }} overflow-hidden rounded-xl">
            <div class="carousel-track flex transition-transform duration-300 ease-in-out">
              {% if section.settings.image %}
                <div class="carousel-slide min-w-full">
                  <img 
                    src="{{ section.settings.image | img_url: '2000x2000' }}" 
                    alt="Imagen 1"
                    class="w-full h-[300px] object-cover object-center"
                    width="{{ section.settings.image.width }}"
                    height="{{ section.settings.image.height }}"
                  >
                </div>
              {% endif %}

              {% if section.settings.image2 %}
                <div class="carousel-slide min-w-full">
                  <img 
                    src="{{ section.settings.image2 | img_url: '2000x2000' }}" 
                    alt="Imagen 2"
                    class="w-full h-[300px] object-cover object-center"
                    width="{{ section.settings.image2.width }}"
                    height="{{ section.settings.image2.height }}"
                  >
                </div>
              {% endif %}

              {% if section.settings.image3 %}
                <div class="carousel-slide min-w-full">
                  <img 
                    src="{{ section.settings.image3 | img_url: '2000x2000' }}" 
                    alt="Imagen 3"
                    class="w-full h-[300px] object-cover object-center"
                    width="{{ section.settings.image3.width }}"
                    height="{{ section.settings.image3.height }}"
                  >
                </div>
              {% endif %}
            </div>
          </div>

          <div class="flex justify-center gap-2 mt-4">
            <button class="carousel-dot-{{ section.id }} w-2 h-2 rounded-full bg-gray-400 transition-all duration-300" data-index="0"></button>
            <button class="carousel-dot-{{ section.id }} w-2 h-2 rounded-full bg-gray-400 transition-all duration-300" data-index="1"></button>
            <button class="carousel-dot-{{ section.id }} w-2 h-2 rounded-full bg-gray-400 transition-all duration-300" data-index="2"></button>
          </div>
        </div>
    </div>


    {% if section.settings.text != blank %}
      <div
        class="absolute md:bottom-0 bottom-15 sm:bottom-30 md:pb-10
              left-1/2 -translate-x-1/2 w-full
              flex justify-center
              md:max-w-6xl max-w-2xl
              md:text-4xl sm:text-3xl text-xl
              text-black px-4 pt-10 text-center"
      >
        {{ section.settings.text }}
      </div>
    {% endif %}

    
</section>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const track = document.querySelector('.carousel-wrapper-{{ section.id }} .carousel-track');
  const dots = document.querySelectorAll('.carousel-dot-{{ section.id }}');
  let currentIndex = 0;
  let autoplayInterval;

  function updateCarousel(index) {
    if (!track) return;
    
    currentIndex = index;
    track.style.transform = `translateX(-${currentIndex * 100}%)`;
    
    dots.forEach((dot, i) => {
      if (i === currentIndex) {
        dot.classList.remove('bg-gray-400');
        dot.classList.add('bg-black', 'w-6');
      } else {
        dot.classList.remove('bg-black', 'w-6');
        dot.classList.add('bg-gray-400');
      }
    });
  }

  function startAutoplay() {
    autoplayInterval = setInterval(() => {
      currentIndex = (currentIndex + 1) % dots.length;
      updateCarousel(currentIndex);
    }, 3000);
  }

  function stopAutoplay() {
    clearInterval(autoplayInterval);
  }

  // Click en los puntos
  dots.forEach(dot => {
    dot.addEventListener('click', () => {
      stopAutoplay();
      updateCarousel(parseInt(dot.dataset.index));
      startAutoplay();
    });
  });

  // Swipe touch
  let startX = 0;
  let isDragging = false;

  if (track) {
    track.addEventListener('touchstart', (e) => {
      startX = e.touches[0].clientX;
      isDragging = true;
      stopAutoplay();
    });

    track.addEventListener('touchmove', (e) => {
      if (!isDragging) return;
      const currentX = e.touches[0].clientX;
      const diff = startX - currentX;
      
      if (Math.abs(diff) > 50) {
        if (diff > 0 && currentIndex < dots.length - 1) {
          currentIndex++;
        } else if (diff < 0 && currentIndex > 0) {
          currentIndex--;
        }
        updateCarousel(currentIndex);
        isDragging = false;
      }
    });

    track.addEventListener('touchend', () => {
      isDragging = false;
      startAutoplay();
    });
  }

  // Iniciar
  updateCarousel(0);
  startAutoplay();
});
</script>

{% schema %}
{
  "name": "Pledge Banner About Us 2",
  "settings": [
    {
      "type": "text",
      "id": "eyebrow",
      "label": "Texto superior (eyebrow)",
      "default": "Our Zero B.S. Pledge"
    },
    {
      "type": "richtext",
      "id": "title",
      "label": "Título",
      "default": "<p>Fourteen years ofcuration, decades of tradition.</p>"
    },
    {
      "type": "richtext",
      "id": "text",
      "label": "Texto pequeño"
    },
    {
      "type": "image_picker",
      "id": "image",
      "label": "Imagen 1" 
    },
    {
      "type": "image_picker",
      "id": "image2",
      "label": "Imagen 2"
    },
    {
      "type": "image_picker",
      "id": "image3",
      "label": "Imagen 3"
    },
    {
      "type": "image_picker",
      "id": "bg_image",
      "label": "Imagen de fondo"
    }

  ],
  "presets": [
    {
      "name": "Pledge Banner About Us 2"
    }
  ]
}
{% endschema %}
